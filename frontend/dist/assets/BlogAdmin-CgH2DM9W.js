import{r,j as e,A as P,m as S}from"./index-zlj08X_R.js";import{R as E}from"./index-DzQncRKk.js";import{a as Q}from"./axios-upsvKRUO.js";/* empty css                   */const B={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{script:"sub"},{script:"super"}],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{indent:"-1"},{indent:"+1"}],[{align:[]}],["clean"]]},D=["header","bold","italic","underline","strike","script","blockquote","list","bullet","indent","align"],H=()=>{const[l,d]=r.useState("create"),[o,c]=r.useState({title:"",image:"",category:"",body:"",author:"",date:""}),[h,g]=r.useState([]),[a,y]=r.useState([]),[T,A]=r.useState([]),[f,N]=r.useState(""),[p,v]=r.useState(""),[L,j]=r.useState(!1),[n,u]=r.useState(null),[k,C]=r.useState(!1);r.useEffect(()=>{q(),F()},[]),r.useEffect(()=>{l==="list"&&w()},[l]);const q=async()=>{try{const s=await(await fetch("/blog/categories")).json();g(s)}catch(t){console.error("Error fetching categories:",t)}},F=async()=>{try{const s=await(await fetch("/blog/authors")).json();y(s)}catch(t){console.error("Error fetching authors:",t)}},w=async()=>{try{const s=await(await fetch("/blog/blogs")).json();A(s)}catch(t){console.error("Error fetching blogs:",t)}},m=t=>{const{name:s,value:i}=t.target;c(b=>({...b,[s]:i}))},R=t=>{c(s=>({...s,body:t}))},O=async t=>{t.preventDefault(),C(!0);try{const s=await fetch("/blog/blogs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!s.ok)throw new Error("Failed to create blog");await s.json(),alert("Blog created successfully!"),c({title:"",image:"",category:"",body:"",author:"",date:""})}catch(s){console.error(s),alert("Error creating blog")}C(!1)},I=async t=>{if(window.confirm("Are you sure you want to delete this blog post?"))try{if(!(await fetch(`/blog/blogs/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete blog");w()}catch(s){console.error(s),alert("Error deleting blog")}},$=t=>{u(t),j(!0)},x=t=>{const{name:s,value:i}=t.target;u(b=>({...b,[s]:i}))},M=t=>{u(s=>({...s,body:t}))},U=async t=>{t.preventDefault();try{const s=await fetch(`/blog/blogs/${n._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!s.ok)throw new Error("Failed to update blog");await s.json(),alert("Blog updated successfully!"),j(!1),u(null),w()}catch(s){console.error(s),alert("Error updating blog")}},_=T.filter(t=>{let s=!0,i=!0;return f&&(s=new Date(t.date).toISOString().split("T")[0]===f),p&&(i=t.title.toLowerCase().includes(p.toLowerCase())||t.body&&t.body.toLowerCase().includes(p.toLowerCase())),s&&i});return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"mb-4 border-b",children:e.jsxs("nav",{className:"flex",children:[e.jsx("button",{onClick:()=>d("create"),className:`px-4 py-2 focus:outline-none ${l==="create"?"border-b-2 border-blue-500 font-semibold":"text-gray-600"}`,children:"Create Blog"}),e.jsx("button",{onClick:()=>d("list"),className:`px-4 py-2 focus:outline-none ${l==="list"?"border-b-2 border-blue-500 font-semibold":"text-gray-600"}`,children:"List Blogs"}),e.jsx("button",{onClick:()=>d("rss"),className:`px-4 py-2 focus:outline-none ${l==="rss"?"border-b-2 border-blue-500 font-semibold":"text-gray-600"}`,children:"RSS Admin"})]})}),l==="create"&&e.jsx("div",{children:e.jsxs("form",{onSubmit:O,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:o.title,onChange:m,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Image URL"}),e.jsx("input",{type:"text",name:"image",value:o.image,onChange:m,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Category"}),e.jsx("input",{list:"categorySuggestions",type:"text",name:"category",value:o.category,onChange:m,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"}),e.jsx("datalist",{id:"categorySuggestions",children:h.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Body"}),e.jsx(E,{theme:"snow",value:o.body,onChange:R,modules:B,formats:D,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Author"}),e.jsx("input",{list:"authorSuggestions",type:"text",name:"author",value:o.author,onChange:m,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"}),e.jsx("datalist",{id:"authorSuggestions",children:a.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:o.date,onChange:m,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsx("button",{type:"submit",disabled:k,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:k?"Submitting...":"Create Blog"})]})}),l==="list"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"date",value:f,onChange:t=>N(t.target.value),className:"border border-gray-300 rounded-md p-2",placeholder:"Filter by Date"}),e.jsx("input",{type:"text",value:p,onChange:t=>v(t.target.value),className:"border border-gray-300 rounded-md p-2",placeholder:"Search by keyword"})]}),e.jsx("button",{onClick:()=>{N(""),v("")},className:"text-blue-500 underline",children:"Clear Filters"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:_.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:new Date(t.date).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap space-x-2",children:[e.jsx("button",{onClick:()=>$(t),className:"text-indigo-600 hover:text-indigo-900",children:"Edit"}),e.jsx("button",{onClick:()=>I(t._id),className:"text-red-600 hover:text-red-900",children:"Delete"})]})]},t._id))})]})})]}),l==="rss"&&e.jsx(J,{}),e.jsx(P,{children:L&&n&&e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs(S.div,{initial:{y:"-100vh"},animate:{y:0},exit:{y:"100vh"},transition:{type:"spring",stiffness:100},className:"bg-white rounded-lg shadow-lg w-11/12 md:w-2/3 lg:w-1/2 max-h-full overflow-y-auto p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Edit Blog"}),e.jsxs("form",{onSubmit:U,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Title"}),e.jsx("input",{type:"text",name:"title",value:n.title,onChange:x,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Image URL"}),e.jsx("input",{type:"text",name:"image",value:n.image,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Category"}),e.jsx("input",{list:"categorySuggestions",type:"text",name:"category",value:n.category,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"}),e.jsx("datalist",{id:"categorySuggestions",children:h.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Body"}),e.jsx(E,{theme:"snow",value:n.body,onChange:M,modules:B,formats:D,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Author"}),e.jsx("input",{list:"authorSuggestions",type:"text",name:"author",value:n.author,onChange:x,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"}),e.jsx("datalist",{id:"authorSuggestions",children:a.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:n.date?n.date.split("T")[0]:"",onChange:x,required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),u(null)},className:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition",children:"Update Blog"})]})]})]})})})]})},J=()=>{const[l,d]=r.useState([]),[o,c]=r.useState("");r.useEffect(()=>{h()},[]);const h=async()=>{try{const a=await Q.get("http://localhost:5000/blogs");d(a.data)}catch(a){console.error("Error fetching blogs:",a)}},g=l.filter(a=>{const y=o.toLowerCase();return a.title.toLowerCase().includes(y)});return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by keyword...",value:o,onChange:a=>c(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring focus:border-blue-300"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 shadow-lg",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Views"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[g.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.title}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(a.date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:a.uniqueIps?a.uniqueIps.length:0})]},a._id)),g.length===0&&e.jsx("tr",{children:e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",colSpan:"3",children:"No blogs found."})})]})]})})]})};export{H as default};
