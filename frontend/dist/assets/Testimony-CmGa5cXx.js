import{G as f,r,R as e,d as g}from"./index-MH5eDRh5.js";import{g as M,c as T,d as h,u as b}from"./index.esm2017-CsCArbGP.js";import{a as z}from"./axios-upsvKRUO.js";function H(s){return f({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"},child:[]}]})(s)}function U(s){return f({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 0 0 0-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 0 0 9.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"},child:[]}]})(s)}function q(s){return f({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0 0 51.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"},child:[]},{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"},child:[]}]})(s)}const I=()=>{const[s,i]=r.useState([]),[v,d]=r.useState(!1),[c,o]=r.useState({id:null,name:"",text:"",imgUrl:""}),[N,p]=r.useState(!1),[l,u]=r.useState(null);r.useEffect(()=>{(async()=>{const n=(await M(T(g,"testimonies"))).docs.map(m=>({id:m.id,...m.data()}));i(n)})()},[]);const w=t=>{o({id:t.id,name:t.name,text:t.text,imgUrl:t.imgUrl||""}),d(!0)},k=async()=>{const{id:t,name:a,text:n,imgUrl:m}=c;try{const x=h(g,"testimonies",t);await b(x,{name:a,text:n,imgUrl:m}),i(s.map(y=>y.id===t?{id:t,name:a,text:n,imgUrl:m}:y)),d(!1),o({id:null,name:"",text:"",imgUrl:""})}catch(x){console.error("Error saving testimony: ",x)}},C=t=>{u({type:"delete",id:t}),p(!0)},D=t=>{u({type:"approve",id:t}),p(!0)},S=async t=>{const a=new FormData;a.append("file",t),a.append("upload_preset","do1kqxdpm"),a.append("cloud_name","do1kqxdpm");try{return(await z.post("https://api.cloudinary.com/v1_1/do1kqxdpm/image/upload",a)).data.secure_url}catch(n){return console.error("Error uploading image to Cloudinary:",n),""}},A=async()=>{if(l){if(l.type==="approve"){const t=h(g,"testimonies",l.id);await b(t,{approved:!0}),i(s.map(a=>a.id===l.id?{...a,approved:!0}:a))}else if(l.type==="delete"){const t=h(g,"testimonies",l.id);await b(t,{approved:!1}),i(s.filter(a=>a.id!==l.id))}}p(!1),u(null)},E=()=>{p(!1),u(null)};return e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("header",{className:"bg-gradient-to-r from-indigo-600 to-blue-500 text-white py-8"},e.createElement("div",{className:"container mx-auto text-center"},e.createElement("h1",{className:"text-4xl font-bold"},"Testimony Admin Dashboard"),e.createElement("p",{className:"mt-2 text-lg"},"Manage and approve customer testimonies"))),e.createElement("div",{className:"container mx-auto px-4 py-8"},e.createElement("div",{className:"overflow-x-auto shadow-lg rounded-lg"},e.createElement("table",{className:"min-w-full table-auto"},e.createElement("thead",{className:"bg-gray-200"},e.createElement("tr",null,e.createElement("th",{className:"px-4 py-2 text-left"},"Name"),e.createElement("th",{className:"px-4 py-2 text-left"},"Date"),e.createElement("th",{className:"px-4 py-2 text-left"},"Testimony"),e.createElement("th",{className:"px-4 py-2 text-left"},"Actions"))),e.createElement("tbody",null,s.sort((t,a)=>new Date(a.date)-new Date(t.date)).map(t=>e.createElement("tr",{key:t.id,className:"border-b hover:bg-gray-50"},e.createElement("td",{className:"px-4 py-2"},t.name),e.createElement("td",{className:"px-4 py-2"},new Date(t.date).toLocaleDateString()),e.createElement("td",{className:"px-4 py-2 truncate max-w-xs"},t.text),e.createElement("td",{className:"px-4 py-2 space-x-4"},e.createElement("button",{onClick:()=>w(t),className:"text-blue-500 hover:text-blue-700"},e.createElement(U,{className:"inline-block"})),e.createElement("button",{onClick:()=>C(t.id),className:"text-red-500 hover:text-red-700"},e.createElement(H,{className:"inline-block"})),e.createElement("button",{onClick:()=>D(t.id),className:`${t.approved?"text-green-500":"text-gray-500"} hover:text-green-700`},e.createElement(q,{className:"inline-block"}))))))))),v&&e.createElement("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex justify-center items-center z-50",onClick:()=>d(!1)},e.createElement("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-lg max-h-[90vh] overflow-y-auto p-8",onClick:t=>t.stopPropagation()},e.createElement("h2",{className:"text-xl font-semibold mb-4"},"Edit Testimony"),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"block text-sm mb-2"},"Name"),e.createElement("input",{type:"text",value:c.name,onChange:t=>o({...c,name:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md"})),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"block text-sm mb-2"},"Testimony"),e.createElement("textarea",{value:c.text,onChange:t=>o({...c,text:t.target.value}),className:"w-full p-2 border border-gray-300 rounded-md",rows:"4"})),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"block text-sm mb-2"},"Image"),e.createElement("input",{type:"file",onChange:async t=>{const a=await S(t.target.files[0]);o({...c,imgUrl:a})},className:"w-full p-2 border border-gray-300 rounded-md"})),e.createElement("div",{className:"flex justify-end space-x-4"},e.createElement("button",{onClick:()=>d(!1),className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md"},"Cancel"),e.createElement("button",{onClick:k,className:"px-4 py-2 bg-indigo-600 text-white rounded-md"},"Save Changes")))),N&&e.createElement("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex justify-center items-center",onClick:E},e.createElement("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-sm",onClick:t=>t.stopPropagation()},e.createElement("h3",{className:"text-lg font-semibold mb-4"},(l==null?void 0:l.type)==="approve"?"Approve Testimony?":"",(l==null?void 0:l.type)==="delete"?"Are you sure you want to delete this testimony?":""),e.createElement("div",{className:"flex justify-between space-x-4"},e.createElement("button",{onClick:E,className:"px-4 py-2 bg-gray-300 text-gray-800 rounded-md"},"Cancel"),e.createElement("button",{onClick:A,className:"px-4 py-2 bg-red-500 text-white rounded-md"},"Confirm")))))};export{I as default};
