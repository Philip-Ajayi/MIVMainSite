import{r as a,R as e,m as S,l as F}from"./index-MH5eDRh5.js";import{a as d}from"./axios-upsvKRUO.js";const M=()=>{const[u,b]=a.useState([]),[o,C]=a.useState(""),[c,m]=a.useState(null),[g,y]=a.useState(""),[s,f]=a.useState("list"),[p,x]=a.useState(""),[h,E]=a.useState(""),[l,N]=a.useState([]),[w,n]=a.useState(null);a.useEffect(()=>{k()},[]);const k=async()=>{try{const t=await d.get("/contact/email");b(t.data)}catch(t){console.error("Error fetching subscribers:",t)}},j=async()=>{if(g.toLowerCase()!=="delete"){alert("Type 'delete' to confirm.");return}try{await d.delete(`/contact/email/${c}`),b(u.filter(t=>t._id!==c)),m(null),y("")}catch(t){console.error("Error deleting subscriber:",t)}},v=u.filter(t=>t.name.toLowerCase().includes(o.toLowerCase())||t.email.toLowerCase().includes(o.toLowerCase())),T=t=>{N(t.target.files)},B=async t=>{t.preventDefault(),n(null);try{const r=new FormData;if(r.append("subject",p),r.append("body",h),l&&l.length>0)for(let i=0;i<l.length;i++)r.append("files",l[i]);(await d.post("/contact/sendSubscribeMessage",r,{headers:{"Content-Type":"multipart/form-data"}})).status===200?(n("Broadcast message sent successfully!"),x(""),E(""),N([])):n("There was an error sending the broadcast message.")}catch(r){console.error("Error sending broadcast message:",r),n("There was an error sending the broadcast message.")}};return e.createElement("div",{className:"p-6 bg-gray-900 min-h-screen text-white"},e.createElement("div",{className:"container mx-auto"},e.createElement("div",{className:"flex flex-col sm:flex-row mb-6 border-b border-gray-700"},e.createElement("button",{onClick:()=>f("list"),className:`py-3 px-6 text-center focus:outline-none ${s==="list"?"bg-gray-800 text-white border-b-2 border-blue-500":"bg-gray-700 text-gray-300"}`},"Subscribers List"),e.createElement("button",{onClick:()=>f("message"),className:`py-3 px-6 text-center focus:outline-none ${s==="message"?"bg-gray-800 text-white border-b-2 border-blue-500":"bg-gray-700 text-gray-300"}`},"Broadcast Message")),s==="list"&&e.createElement("div",null,e.createElement("h2",{className:"text-3xl font-bold text-center mb-6"},"Subscribers List"),e.createElement("div",{className:"mb-4"},e.createElement("input",{type:"text",placeholder:"Search by name or email...",className:"w-full p-2 rounded bg-gray-800 border border-gray-600 focus:outline-none focus:border-blue-500",value:o,onChange:t=>C(t.target.value)})),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full bg-gray-800 rounded-lg overflow-hidden"},e.createElement("thead",null,e.createElement("tr",{className:"bg-gray-700 text-left text-gray-300"},e.createElement("th",{className:"py-3 px-4"},"Name"),e.createElement("th",{className:"py-3 px-4"},"Email"),e.createElement("th",{className:"py-3 px-4 text-center"},"Action"))),e.createElement("tbody",null,v.length>0?v.map((t,r)=>e.createElement(S.tr,{key:t._id,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:r*.1},className:"border-b border-gray-700 hover:bg-gray-750 transition"},e.createElement("td",{className:"py-3 px-4"},t.name),e.createElement("td",{className:"py-3 px-4"},t.email),e.createElement("td",{className:"py-3 px-4 text-center"},e.createElement("button",{onClick:()=>m(t._id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded transition"},e.createElement(F,null))))):e.createElement("tr",null,e.createElement("td",{colSpan:"3",className:"text-center py-4 text-gray-400"},"No subscribers found")))))),s==="message"&&e.createElement("div",{className:"max-w-xl mx-auto"},e.createElement("h2",{className:"text-3xl font-bold text-center mb-6"},"Broadcast Message"),e.createElement("form",{onSubmit:B,className:"space-y-6 bg-gray-800 p-6 rounded-lg"},e.createElement("div",null,e.createElement("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-300"},"Subject"),e.createElement("input",{type:"text",id:"subject",name:"subject",required:!0,value:p,onChange:t=>x(t.target.value),placeholder:"Enter subject (you can use {name})",className:"mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:border-blue-500"})),e.createElement("div",null,e.createElement("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-300"},"Body"),e.createElement("textarea",{id:"body",name:"body",rows:"6",required:!0,value:h,onChange:t=>E(t.target.value),placeholder:"Enter message body (you can use {name})",className:"mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:border-blue-500"})),e.createElement("div",null,e.createElement("label",{htmlFor:"files",className:"block text-sm font-medium text-gray-300"},"Attach Files (optional)"),e.createElement("input",{type:"file",id:"files",name:"files",multiple:!0,onChange:T,className:"mt-1 block w-full text-gray-300 bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:border-blue-500"})),e.createElement("button",{type:"submit",className:"w-full py-2 px-4 bg-blue-700 text-white font-semibold rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},"Send Broadcast"),w&&e.createElement("p",{className:"text-center text-sm mt-2 text-gray-300"},w)))),c&&e.createElement("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60"},e.createElement(S.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},className:"bg-gray-800 p-6 rounded-lg shadow-lg text-center"},e.createElement("h3",{className:"text-xl font-bold text-red-500 mb-3"},"Confirm Deletion"),e.createElement("p",{className:"text-gray-300 mb-2"},"Type ",e.createElement("strong",null,"delete")," to confirm:"),e.createElement("input",{type:"text",className:"w-full p-2 rounded bg-gray-700 border border-gray-500 focus:outline-none focus:border-red-500 mb-3",value:g,onChange:t=>y(t.target.value)}),e.createElement("div",{className:"flex justify-center gap-4"},e.createElement("button",{onClick:j,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded transition"},"Confirm"),e.createElement("button",{onClick:()=>m(null),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded transition"},"Cancel")))))};export{M as default};
