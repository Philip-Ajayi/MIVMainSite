import{r as s,j as e,m as N,h as k}from"./index-zlj08X_R.js";import{a as i}from"./axios-upsvKRUO.js";const B=()=>{const[d,u]=s.useState([]),[n,w]=s.useState(""),[c,l]=s.useState(null),[b,x]=s.useState(""),[r,m]=s.useState("list"),[h,g]=s.useState(""),[y,p]=s.useState(""),[f,a]=s.useState(null);s.useEffect(()=>{v()},[]);const v=async()=>{try{const t=await i.get("/contact/email");u(t.data)}catch(t){console.error("Error fetching subscribers:",t)}},S=async()=>{if(b.toLowerCase()!=="delete"){alert("Type 'delete' to confirm.");return}try{await i.delete(`/contact/email/${c}`),u(d.filter(t=>t._id!==c)),l(null),x("")}catch(t){console.error("Error deleting subscriber:",t)}},j=d.filter(t=>t.name.toLowerCase().includes(n.toLowerCase())||t.email.toLowerCase().includes(n.toLowerCase())),C=async t=>{t.preventDefault(),a(null);try{(await i.post("/contact/sendSubscribeMessage",{subject:h,body:y})).status===200?(a("Broadcast message sent successfully!"),g(""),p("")):a("There was an error sending the broadcast message.")}catch(o){console.error("Error sending broadcast message:",o),a("There was an error sending the broadcast message.")}};return e.jsxs("div",{className:"p-6 bg-gray-900 min-h-screen text-white",children:[e.jsxs("div",{className:"container mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row mb-6 border-b border-gray-700",children:[e.jsx("button",{onClick:()=>m("list"),className:`py-3 px-6 text-center focus:outline-none ${r==="list"?"bg-gray-800 text-white border-b-2 border-blue-500":"bg-gray-700 text-gray-300"}`,children:"Subscribers List"}),e.jsx("button",{onClick:()=>m("message"),className:`py-3 px-6 text-center focus:outline-none ${r==="message"?"bg-gray-800 text-white border-b-2 border-blue-500":"bg-gray-700 text-gray-300"}`,children:"Broadcast Message"})]}),r==="list"&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-6",children:"Subscribers List"}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search by name or email...",className:"w-full p-2 rounded bg-gray-800 border border-gray-600 focus:outline-none focus:border-blue-500",value:n,onChange:t=>w(t.target.value)})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-gray-800 rounded-lg overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-700 text-left text-gray-300",children:[e.jsx("th",{className:"py-3 px-4",children:"Name"}),e.jsx("th",{className:"py-3 px-4",children:"Email"}),e.jsx("th",{className:"py-3 px-4 text-center",children:"Action"})]})}),e.jsx("tbody",{children:j.length>0?j.map((t,o)=>e.jsxs(N.tr,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:o*.1},className:"border-b border-gray-700 hover:bg-gray-750 transition",children:[e.jsx("td",{className:"py-3 px-4",children:t.name}),e.jsx("td",{className:"py-3 px-4",children:t.email}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("button",{onClick:()=>l(t._id),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded transition",children:e.jsx(k,{})})})]},t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",className:"text-center py-4 text-gray-400",children:"No subscribers found"})})})]})})]}),r==="message"&&e.jsxs("div",{className:"max-w-xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-6",children:"Broadcast Message"}),e.jsxs("form",{onSubmit:C,className:"space-y-6 bg-gray-800 p-6 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-300",children:"Subject"}),e.jsx("input",{type:"text",id:"subject",name:"subject",required:!0,value:h,onChange:t=>g(t.target.value),placeholder:"Enter subject (you can use {name})",className:"mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"body",className:"block text-sm font-medium text-gray-300",children:"Body"}),e.jsx("textarea",{id:"body",name:"body",rows:"6",required:!0,value:y,onChange:t=>p(t.target.value),placeholder:"Enter message body (you can use {name})",className:"mt-1 block w-full p-2 bg-gray-700 border border-gray-600 rounded-md shadow-sm focus:outline-none focus:border-blue-500"})]}),e.jsx("button",{type:"submit",className:"w-full py-2 px-4 bg-blue-700 text-white font-semibold rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Send Broadcast"}),f&&e.jsx("p",{className:"text-center text-sm mt-2 text-gray-300",children:f})]})]})]}),c&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-60",children:e.jsxs(N.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},className:"bg-gray-800 p-6 rounded-lg shadow-lg text-center",children:[e.jsx("h3",{className:"text-xl font-bold text-red-500 mb-3",children:"Confirm Deletion"}),e.jsxs("p",{className:"text-gray-300 mb-2",children:["Type ",e.jsx("strong",{children:"delete"})," to confirm:"]}),e.jsx("input",{type:"text",className:"w-full p-2 rounded bg-gray-700 border border-gray-500 focus:outline-none focus:border-red-500 mb-3",value:b,onChange:t=>x(t.target.value)}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:S,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded transition",children:"Confirm"}),e.jsx("button",{onClick:()=>l(null),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded transition",children:"Cancel"})]})]})})]})};export{B as default};
