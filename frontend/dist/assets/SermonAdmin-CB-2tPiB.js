import{r as n,j as e,A as S,m as p}from"./index-zlj08X_R.js";const z=()=>{const[m,j]=n.useState("create"),[g,w]=n.useState([]),[k,C]=n.useState([]),[F,E]=n.useState([]),[r,h]=n.useState({name:"",date:"",speaker:"",series:"",thumbnail:null,audioFile:null}),[N,v]=n.useState(!1),[u,D]=n.useState(""),[b,L]=n.useState(""),[q,f]=n.useState(!1),[T,A]=n.useState(null),[l,y]=n.useState({name:"",date:"",speaker:"",series:"",thumbnail:null,audioFile:null});n.useEffect(()=>{fetch("/sermon/speakers").then(t=>t.json()).then(t=>w(t)).catch(t=>console.error("Error fetching speakers:",t)),fetch("/sermon/series").then(t=>t.json()).then(t=>C(t)).catch(t=>console.error("Error fetching series:",t)),x()},[]);const x=()=>{fetch("/sermon/items").then(t=>t.json()).then(t=>E(t)).catch(t=>console.error("Error fetching sermons:",t))},o=t=>{const{name:s,value:a,files:c}=t.target;h(c?i=>({...i,[s]:c[0]}):i=>({...i,[s]:a}))},I=async t=>{t.preventDefault(),v(!0);const s=new FormData;s.append("name",r.name),s.append("date",r.date),s.append("speaker",r.speaker),s.append("series",r.series),r.thumbnail&&s.append("thumbnail",r.thumbnail),r.audioFile&&s.append("audioFile",r.audioFile);try{if(!(await fetch("/sermon/upload",{method:"POST",body:s})).ok)throw new Error("Failed to create sermon");alert("Sermon created successfully!"),h({name:"",date:"",speaker:"",series:"",thumbnail:null,audioFile:null}),x()}catch(a){console.error(a),alert(a.message)}v(!1)},O=async t=>{if(window.confirm("Are you sure you want to delete this sermon?"))try{if(!(await fetch(`/sermon//items/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete sermon");alert("Sermon deleted successfully!"),x()}catch(s){console.error(s),alert(s.message)}},M=t=>{A(t),y({name:t.name,date:new Date(t.date).toISOString().substring(0,10),speaker:t.speaker,series:t.series,thumbnail:null,audioFile:null}),f(!0)},d=t=>{const{name:s,value:a,files:c}=t.target;y(c?i=>({...i,[s]:c[0]}):i=>({...i,[s]:a}))},$=async t=>{t.preventDefault();const s=new FormData;s.append("name",l.name),s.append("date",l.date),s.append("speaker",l.speaker),s.append("series",l.series),l.thumbnail&&s.append("thumbnail",l.thumbnail),l.audioFile&&s.append("audioFile",l.audioFile);try{if(!(await fetch(`/sermon//edit/${T._id}`,{method:"PUT",body:s})).ok)throw new Error("Failed to update sermon");alert("Sermon updated successfully!"),f(!1),x()}catch(a){console.error(a),alert(a.message)}},P=F.filter(t=>{const s=t.name.toLowerCase().includes(u.toLowerCase())||t.series.toLowerCase().includes(u.toLowerCase())||t.speaker.toLowerCase().includes(u.toLowerCase()),a=b?new Date(t.date).toISOString().substring(0,10)===b:!0;return s&&a});return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsxs("div",{className:"mb-4 flex border-b",children:[e.jsx("button",{className:`px-4 py-2 -mb-px font-semibold ${m==="create"?"border-b-2 border-blue-500 text-blue-500":"text-gray-500"}`,onClick:()=>j("create"),children:"Create Sermon"}),e.jsx("button",{className:`px-4 py-2 -mb-px font-semibold ${m==="list"?"border-b-2 border-blue-500 text-blue-500":"text-gray-500"}`,onClick:()=>j("list"),children:"Manage Sermons"})]}),e.jsxs(S,{exitBeforeEnter:!0,children:[m==="create"&&e.jsx(p.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},children:e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:r.name,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:r.date,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Speaker"}),e.jsx("input",{type:"text",name:"speaker",value:r.speaker,onChange:o,list:"speakersList",className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0}),e.jsx("datalist",{id:"speakersList",children:g.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Series"}),e.jsx("input",{type:"text",name:"series",value:r.series,onChange:o,list:"seriesList",className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0}),e.jsx("datalist",{id:"seriesList",children:k.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail"}),e.jsx("input",{type:"file",name:"thumbnail",onChange:o,className:"mt-1 block w-full",accept:"image/*",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Audio File"}),e.jsx("input",{type:"file",name:"audioFile",onChange:o,className:"mt-1 block w-full",accept:"audio/*",required:!0})]}),e.jsx("button",{type:"submit",disabled:N,className:"bg-blue-500 hover:bg-blue-600 text-white font-semibold px-4 py-2 rounded",children:N?"Submitting...":"Submit Sermon"})]})},"create"),m==="list"&&e.jsxs(p.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center gap-4 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Search by name, series, speaker",value:u,onChange:t=>D(t.target.value),className:"border border-gray-300 rounded p-2 flex-1"}),e.jsx("input",{type:"date",value:b,onChange:t=>L(t.target.value),className:"border border-gray-300 rounded p-2"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white border",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 border",children:"Name"}),e.jsx("th",{className:"px-4 py-2 border",children:"Series"}),e.jsx("th",{className:"px-4 py-2 border",children:"Date"}),e.jsx("th",{className:"px-4 py-2 border",children:"Actions"})]})}),e.jsx("tbody",{children:P.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-2 border",children:t.name}),e.jsx("td",{className:"px-4 py-2 border",children:t.series}),e.jsx("td",{className:"px-4 py-2 border",children:new Date(t.date).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-2 border space-x-2",children:[e.jsx("button",{onClick:()=>M(t),className:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded",children:"Edit"}),e.jsx("button",{onClick:()=>O(t._id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded",children:"Delete"})]})]},t._id))})]})})]},"list")]}),e.jsx(S,{children:q&&e.jsx(p.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsxs(p.div,{className:"bg-white rounded-lg w-full max-w-lg mx-4 overflow-y-auto max-h-full p-6",initial:{scale:.8},animate:{scale:1},exit:{scale:.8},children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Edit Sermon"}),e.jsxs("form",{onSubmit:$,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:l.name,onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:l.date,onChange:d,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Speaker"}),e.jsx("input",{type:"text",name:"speaker",value:l.speaker,onChange:d,list:"editSpeakersList",className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0}),e.jsx("datalist",{id:"editSpeakersList",children:g.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Series"}),e.jsx("input",{type:"text",name:"series",value:l.series,onChange:d,list:"editSeriesList",className:"mt-1 block w-full border border-gray-300 rounded-md p-2",required:!0}),e.jsx("datalist",{id:"editSeriesList",children:k.map((t,s)=>e.jsx("option",{value:t},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Thumbnail"}),e.jsx("input",{type:"file",name:"thumbnail",onChange:d,className:"mt-1 block w-full",accept:"image/*"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Audio File"}),e.jsx("input",{type:"file",name:"audioFile",onChange:d,className:"mt-1 block w-full",accept:"audio/*"})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded",children:"Cancel"}),e.jsx("button",{type:"submit",className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded",children:"Save Changes"})]})]})]})})})]})};export{z as default};
