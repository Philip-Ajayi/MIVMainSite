import{r as n,b as E,o as G,R as e,m as r,A as I,d as v,s as P,c as T,e as R}from"./index-CwW1t-7z.js";import{a as m}from"./axios-upsvKRUO.js";const Q="/assets/xlogo-D7jQRCoH.png",$=()=>{const z="https://stream-175.zeno.fm/qqgdtv5o3isuv?zt=eyJhbGciOiJIUzI1NiJ9.eyJzdHJlYW0iOiJxcWdkdHY1bzNpc3V2IiwiaG9zdCI6InN0cmVhbS0xNzUuemVuby5mbSIsInJ0dGwiOjUsImp0aSI6IkMtU1lkY2dQUmphVllwRlhHSDBrbnciLCJpYXQiOjE3MzkyNTQyNzAsImV4cCI6MTczOTI1NDMzMH0.jC0UwgRTNlkcWPDofZQmtP3HftoqunVxEd3EjGF9l9w",[d,h]=n.useState(!1),[V,u]=n.useState(!1),c=n.useRef(null),[N,J]=n.useState(null),[w,S]=n.useState(null),[M,C]=n.useState([]),[l,A]=n.useState(null),[O,y]=n.useState([]),[i,f]=n.useState({userName:"",comment:""}),[q,U]=n.useState(0),[p]=n.useState(()=>Math.random().toString(36).substring(2,15)),[o,b]=n.useState(null);n.useEffect(()=>{const t=new EventSource("https://api.zeno.fm/mounts/metadata/subscribe/qqgdtv5o3isuv");return t.onmessage=a=>{try{const s=JSON.parse(a.data);s.mount==="qqgdtv5o3isuv"&&s.streamTitle&&J({name:s.streamTitle})}catch(s){console.error("Error parsing SSE data:",s)}},t.onerror=a=>{console.error("EventSource error:",a),t.close()},()=>{t.close()}},[]);const k=async()=>{try{const t=await m.get("/radio/schedule/next");S(t.data)}catch(t){console.error("Error fetching next playing:",t),S(null)}},L=async()=>{try{const t=await m.get("/radio/schedule/future");C(Array.isArray(t.data)?t.data:[])}catch(t){console.error("Error fetching schedule:",t),C([])}},j=async()=>{try{let a=(await m.get("/radio/chatsession/all")).data;Array.isArray(a)||(a=Object.values(a));const s=new Date,g=a.find(x=>{const B=new Date(x.startTime),F=new Date(x.endTime);return B<=s&&F>=s});A(g)}catch(t){console.error("Error fetching active chat session:",t),A(null)}},D=async()=>{if(!l){y([]);return}try{const t=await m.get(`/radio/chatsession/${l._id}/comments`);y(Array.isArray(t.data)?t.data:[])}catch(t){console.error("Error fetching chat messages:",t),y([])}};n.useEffect(()=>{k(),L(),j();const t=setInterval(()=>{k(),L(),j()},1e4);return()=>clearInterval(t)},[]),n.useEffect(()=>{D()},[l]),n.useEffect(()=>{const t=E(v,"activeListeners"),a=G(t,s=>{const g=s.val(),x=g?Object.keys(g).length:0;U(x)});return()=>a()},[]);const H=()=>{const t=E(v,`activeListeners/${p}`);d?(c.current.pause(),h(!1),R(t)):(u(!0),c.current.play().then(()=>{if(c.current.readyState>=4)u(!1),h(!0),P(t,!0),T(t).remove();else{const a=()=>{u(!1),h(!0),P(t,!0),T(t).remove(),c.current.removeEventListener("canplaythrough",a)};c.current.addEventListener("canplaythrough",a)}}).catch(a=>{u(!1),console.error("Audio playback error:",a)}))};n.useEffect(()=>{const t=()=>{d&&R(E(v,`activeListeners/${p}`))};return window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t)},[d,p]);const Y=async t=>{if(t.preventDefault(),!!l)try{await m.post(`/radio/chatsession/${l._id}/comment`,{name:i.userName,comment:i.comment}),f({userName:"",comment:""}),D()}catch(a){console.error("Error sending chat message:",a)}};return e.createElement("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-gray-100 py-8 px-4"},e.createElement("div",{className:"max-w-6xl mx-auto"},e.createElement(r.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.8},className:"flex flex-col items-center mb-12"},e.createElement("img",{src:Q,alt:"Radio Logo",className:"h-28 w-auto mb-4"}),e.createElement("h1",{className:"text-4xl md:text-5xl font-extrabold text-gray-800 text-center"},"Expression Radio"),e.createElement("p",{className:"mt-2 text-lg md:text-xl text-gray-600 text-center max-w-2xl"},"Strong in Sound! Vigorous in Vibe! Victorious in Voice!")),e.createElement("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-12"},e.createElement("div",{className:"flex flex-col items-center"},e.createElement("audio",{ref:c,src:z,preload:"none"}),e.createElement(r.button,{onClick:H,whileHover:{scale:1.1,rotate:5},whileTap:{scale:.9},className:"mb-6 bg-gradient-to-r from-purple-500 to-indigo-500 hover:from-purple-600 hover:to-indigo-600 text-white p-4 rounded-full focus:outline-none transition duration-300 shadow-lg flex items-center justify-center"},e.createElement(I,{exitBeforeEnter:!0,initial:!1},V?e.createElement(r.div,{key:"loader",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.3}},e.createElement("svg",{className:"animate-spin h-8 w-8",viewBox:"0 0 24 24"},e.createElement("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.createElement("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"}))):d?e.createElement(r.g,{key:"pause",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.3}},e.createElement("svg",{width:"50",height:"50",viewBox:"0 0 50 50"},e.createElement("rect",{x:"12",y:"10",width:"8",height:"30",fill:"#fff",rx:"2"}),e.createElement("rect",{x:"30",y:"10",width:"8",height:"30",fill:"#fff",rx:"2"}))):e.createElement(r.svg,{key:"play",width:"50",height:"50",viewBox:"0 0 50 50",initial:{opacity:0,scale:.5},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.5},transition:{duration:.3}},e.createElement("polygon",{points:"15,10 40,25 15,40",fill:"#fff"})))),e.createElement("div",{className:"text-center"},e.createElement(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"text-2xl font-semibold text-gray-800"},"Now Playing: ",e.createElement("span",{className:"text-indigo-600"},N?N.name:"N/A")),e.createElement(r.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"text-2xl font-semibold text-gray-800 mt-1"},"Next Playing: ",e.createElement("span",{className:"text-indigo-600"},w?w.name:"N/A")),e.createElement("div",{className:"mt-4 text-gray-600 text-sm hidden"},"Active Listeners: ",q)))),e.createElement("div",{className:"bg-white rounded-xl shadow-lg p-6 mb-12"},e.createElement("div",{className:"flex flex-col md:flex-row items-center"},e.createElement("div",{className:"md:w-1/2 flex justify-center mb-6 md:mb-0"},e.createElement("img",{src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS8rYejO4FtGX9dlJ1_hFCFJs26RCrbr7A0jA&s",alt:"About Us",className:"rounded-xl shadow-lg w-64 h-64 object-cover"})),e.createElement("div",{className:"md:w-1/2 md:pl-8"},e.createElement("h2",{className:"text-3xl font-bold text-gray-800 mb-4"},"About Us"),e.createElement("p",{className:"text-gray-700 mb-3 text-base md:text-lg",style:{textAlign:"justify"}},"Expression Radio is more than just an online station—it’s a movement. Created as an extension of our church’s vision, Expression Radio is a platform where faith, creativity, and culture collide."),e.createElement("p",{className:"text-gray-700 mb-3 text-base md:text-lg",style:{textAlign:"justify"}},"Our mission is to inspire, uplift, and connect people through powerful messages, dynamic worship, and engaging discussions on topics that matter."),e.createElement("p",{className:"text-gray-700 text-base md:text-lg",style:{textAlign:"justify"}},"Whether you’re tuning in for live worship sessions or thoughtful conversations, you’re an essential part of our community. Let your spirit soar with every beat and every word.")))),e.createElement("div",{className:"mb-12"},e.createElement("h2",{className:"text-3xl font-bold text-gray-800 text-center mb-6"},"Our Schedule"),e.createElement("div",{className:"space-y-4"},M.map(t=>e.createElement("div",{key:t._id,className:"flex justify-between items-center bg-white p-4 rounded shadow"},e.createElement("div",null,e.createElement("h3",{className:"text-xl md:text-2xl font-semibold"},t.name),e.createElement("p",{className:"text-gray-600 text-sm md:text-base"},new Date(t.scheduleTime).toLocaleDateString()," at ",new Date(t.scheduleTime).toLocaleTimeString())),e.createElement("button",{className:"bg-indigo-600 text-white px-4 py-2 rounded",onClick:()=>b(t)},"View Details"))))),e.createElement(I,null,o&&e.createElement(r.div,{key:"scheduleModal",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-70 z-50",onClick:()=>b(null)},e.createElement(r.div,{className:"bg-white rounded-lg p-6 max-w-lg w-full",onClick:t=>t.stopPropagation()},e.createElement("h3",{className:"text-2xl font-bold mb-4"},o.name),e.createElement("p",{className:"text-gray-600 mb-2"},new Date(o.scheduleTime).toLocaleDateString()," at ",new Date(o.scheduleTime).toLocaleTimeString()),o.image&&e.createElement("img",{src:o.image,alt:o.name,className:"w-full h-64 object-contain mb-4"}),e.createElement("p",{className:"text-gray-700 mb-4"},o.description),e.createElement("button",{className:"bg-indigo-600 text-white px-4 py-2 rounded",onClick:()=>b(null)},"Close")))),e.createElement("div",{className:"bg-white rounded-xl shadow-lg p-6"},e.createElement("h2",{className:"text-3xl font-bold text-gray-800 text-center mb-6"},"Chat"),l?e.createElement("div",{className:"flex flex-col"},e.createElement("div",{className:"h-64 overflow-y-auto mb-4 border border-gray-200 rounded-lg p-4"},O.map(t=>e.createElement("div",{key:t._id,className:"mb-3"},e.createElement("p",{className:"text-base md:text-lg"},e.createElement("span",{className:"font-bold text-indigo-600"},t.name,":")," ",t.comment),e.createElement("p",{className:"text-sm md:text-base text-gray-500"},new Date(t.createdAt).toLocaleTimeString())))),e.createElement("form",{onSubmit:Y,className:"flex flex-col sm:flex-row gap-4"},e.createElement("input",{type:"text",placeholder:"Your name",value:i.userName,onChange:t=>f({...i,userName:t.target.value}),className:"flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400",required:!0}),e.createElement("input",{type:"text",placeholder:"Your comment",value:i.comment,onChange:t=>f({...i,comment:t.target.value}),className:"flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-400",required:!0}),e.createElement("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-lg transition"},"Send"))):e.createElement("div",{className:"bg-gray-100 p-6 rounded-lg text-center"},e.createElement("p",{className:"text-gray-700"},"Chat is currently closed. Please check back later.")))))};export{$ as default};
