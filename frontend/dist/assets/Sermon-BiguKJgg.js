import{r as t,j as e,m as N}from"./index-zlj08X_R.js";const h=({children:r,className:p=""})=>{const i=t.useRef(null),[u,n]=t.useState(!1);return t.useEffect(()=>{const c=new IntersectionObserver(([o])=>{o.isIntersecting&&(n(!0),c.disconnect())},{threshold:.1});return i.current&&c.observe(i.current),()=>{c.disconnect()}},[]),e.jsx("div",{ref:i,className:p,children:u?r:null})},A=()=>{const[r,p]=t.useState([]),[i,u]=t.useState([]),[n,c]=t.useState(""),[o,w]=t.useState(""),[d,y]=t.useState(""),[S,k]=t.useState([]),[F,C]=t.useState([]),[f,g]=t.useState(6);t.useEffect(()=>{fetch("http://localhost:5000/sermon/items").then(s=>s.json()).then(s=>{p(s),u(s);const l=Array.from(new Set(s.map(x=>new Date(x.date).getFullYear()))).sort((x,D)=>D-x);k(l);const m=Array.from(new Set(s.map(x=>x.speaker)));C(m)}).catch(s=>console.error(s))},[]),t.useEffect(()=>{let s=r;if(n&&(s=s.filter(l=>new Date(l.date).getFullYear().toString()===n)),o&&(s=s.filter(l=>l.speaker===o)),d){const l=d.toLowerCase();s=s.filter(m=>m.name.toLowerCase().includes(l)||m.series.toLowerCase().includes(l)||m.speaker.toLowerCase().includes(l))}u(s),g(6)},[n,o,d,r]);const j=n||o||d,a=r[0],b=!j&&r.length>1?r.slice(1):i,v=s=>new Date(s).toLocaleDateString();return e.jsxs("div",{className:"container mx-auto px-4 py-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Sermons"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("select",{value:n,onChange:s=>c(s.target.value),className:"border border-gray-300 rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"All Years"}),S.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("select",{value:o,onChange:s=>w(s.target.value),className:"border border-gray-300 rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"All Speakers"}),F.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsx("input",{type:"text",placeholder:"Search by name, series or speaker",value:d,onChange:s=>y(s.target.value),className:"border border-gray-300 rounded px-3 py-2 w-full md:w-64"})})]}),!j&&a&&e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"bg-white shadow-lg rounded-lg p-6 mb-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx(h,{className:"flex-shrink-0 w-64 h-64",children:e.jsx("img",{src:`https://drive.google.com/thumbnail?id=${a.thumbnail}`,alt:a.name,className:"object-cover w-full h-full rounded"})}),e.jsxs("div",{className:"flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500 uppercase",children:"Last Sermon"}),e.jsx("h2",{className:"text-2xl font-bold mt-2",children:a.name}),e.jsxs("p",{className:"text-gray-700 mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Speaker:"})," ",a.speaker]}),e.jsxs("p",{className:"text-gray-700 mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Series:"})," ",a.series]}),e.jsxs("p",{className:"text-gray-700 mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Date:"})," ",v(a.date)]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Current Series"})]}),e.jsx("div",{className:"mt-4 flex items-center gap-4",children:e.jsx("a",{href:`https://drive.google.com/uc?export=download&id=${a.audioFile}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded",children:"Download Audio"})})]})]}),e.jsx(h,{className:"mt-6",children:e.jsx("iframe",{src:`https://drive.google.com/file/d/${a.audioFile}/preview`,title:"Audio Preview",className:"w-full h-20 md:h-24 rounded",allow:"autoplay",loading:"lazy"})})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:b.slice(0,f).map((s,l)=>e.jsxs(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.1},className:"bg-white shadow rounded-lg overflow-hidden flex flex-col",children:[e.jsx(h,{className:"relative aspect-square",children:e.jsx("img",{src:`https://drive.google.com/thumbnail?id=${s.thumbnail}`,alt:s.name,className:"object-cover w-full h-full"})}),e.jsxs("div",{className:"p-4 flex flex-col flex-grow",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:s.name}),e.jsxs("p",{className:"text-gray-600 text-sm mb-1",children:[e.jsx("span",{className:"font-medium",children:"Speaker:"})," ",s.speaker]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-1",children:[e.jsx("span",{className:"font-medium",children:"Series:"})," ",s.series]}),e.jsxs("p",{className:"text-gray-600 text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:"Date:"})," ",v(s.date)]}),e.jsxs("div",{className:"mt-auto flex flex-col gap-2",children:[e.jsx("a",{href:`https://drive.google.com/uc?export=download&id=${s.audioFile}`,target:"_blank",rel:"noopener noreferrer",className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded text-center",children:"Download Audio"}),e.jsx(h,{className:"w-full",children:e.jsx("iframe",{src:`https://drive.google.com/file/d/${s.audioFile}/preview`,title:"Audio Preview",className:"w-full h-16 rounded",allow:"autoplay",loading:"lazy"})})]})]})]},s._id))}),f<b.length&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx("button",{onClick:()=>g(s=>s+6),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded",children:"Load More"})})]})};export{A as default};
